<ng-container *transloco="let t">
  <div [class]="pickerClasses()">
    @if (variant() === 'dropdown') {
      <!-- Dropdown Trigger Button -->
      <button
        type="button"
        class="language-switcher__button"
        [attr.aria-label]="dropdownAriaLabel()"
        [attr.aria-expanded]="isOpen()"
        aria-haspopup="listbox"
        (click)="toggleDropdown()"
        (keydown)="handleKeydown($event)"
      >
        <eb-icon name="heroGlobeAlt" [size]="size()" aria-hidden="true" />
        <span class="language-switcher__code">{{ currentLanguage().code.toUpperCase() }}</span>
        <eb-icon
          name="heroChevronDown"
          size="sm"
          aria-hidden="true"
          class="language-switcher__chevron"
          [class.language-switcher__chevron--open]="isOpen()"
        />
      </button>

      <!-- Dropdown Menu -->
      @if (isOpen()) {
        <div class="language-switcher__dropdown">
          <!-- Backdrop for click-outside -->
          <div
            class="language-switcher__backdrop"
            (click)="closeDropdown()"
            (keydown.escape)="closeDropdown()"
            tabindex="-1"
            aria-hidden="true"
          ></div>

          <!-- Options List -->
          <ul class="language-switcher__menu" role="listbox">
            @for (language of languages; track language.code) {
              <li
                role="option"
                class="language-switcher__option"
                [class.language-switcher__option--selected]="
                  language.code === currentLanguage().code
                "
                [attr.aria-selected]="language.code === currentLanguage().code"
                tabindex="0"
                (click)="selectLanguage(language)"
                (keydown.enter)="selectLanguage(language)"
                (keydown.space)="selectLanguage(language); $event.preventDefault()"
              >
                <span class="language-switcher__option-code">{{
                  language.code.toUpperCase()
                }}</span>
                <span class="language-switcher__option-name">{{ language.nativeName }}</span>
                @if (language.code === currentLanguage().code) {
                  <eb-icon name="heroCheck" size="sm" aria-hidden="true" />
                }
              </li>
            }
          </ul>
        </div>
      }
    } @else {
      <!-- Inline Variant -->
      @for (language of languages; track language.code) {
        <button
          type="button"
          class="language-switcher__inline-button"
          [class.language-switcher__inline-button--active]="
            language.code === currentLanguage().code
          "
          [attr.aria-label]="language.nativeName"
          [attr.aria-pressed]="language.code === currentLanguage().code"
          (click)="selectLanguage(language)"
        >
          {{ language.code.toUpperCase() }}
        </button>
      }
    }
  </div>
</ng-container>
