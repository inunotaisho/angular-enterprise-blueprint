<ng-container *transloco="let t">
  <div [class]="pickerClasses()">
    @if (variant() === 'dropdown' || variant() === 'icon') {
      @if (variant() === 'icon') {
        <!-- Icon Trigger Button -->
        <eb-button
          variant="tertiary"
          [size]="size()"
          [iconOnly]="true"
          class="language-switcher__icon-trigger"
          [ariaLabel]="changeLanguageTooltip"
          [ebTooltip]="changeLanguageTooltip"
          [ariaExpanded]="isOpen()"
          ariaHasPopup="listbox"
          [ariaControls]="isOpen() ? 'language-listbox' : undefined"
          (clicked)="toggleDropdown()"
        >
          <eb-icon name="heroGlobeAlt" [size]="size()" aria-hidden="true" />
        </eb-button>
      } @else {
        <!-- Dropdown Trigger Button -->
        <eb-button
          variant="ghost"
          [size]="size()"
          (clicked)="toggleDropdown()"
          [ariaLabel]="dropdownAriaLabel()"
          [ariaExpanded]="isOpen()"
          ariaHasPopup="listbox"
          [ariaControls]="isOpen() ? 'language-listbox' : undefined"
          class="language-switcher__button"
        >
          <div class="language-switcher__trigger-content">
            <eb-icon name="heroGlobeAlt" [size]="size()" aria-hidden="true" />
            <span class="language-switcher__code">{{ currentLanguage().code.toUpperCase() }}</span>
            <eb-icon
              name="heroChevronDown"
              size="sm"
              aria-hidden="true"
              class="language-switcher__chevron"
              [class.language-switcher__chevron--open]="isOpen()"
            />
          </div>
        </eb-button>
      }

      <!-- Dropdown Menu -->
      @if (isOpen()) {
        <div class="language-switcher__dropdown">
          <!-- Options List -->
          <ul id="language-listbox" class="language-switcher__menu" role="listbox">
            @for (language of languages; track language.code) {
              <li
                role="option"
                class="language-switcher__option"
                [class.language-switcher__option--selected]="
                  language.code === currentLanguage().code
                "
                [attr.aria-selected]="language.code === currentLanguage().code"
                tabindex="0"
                (click)="selectLanguage(language)"
                (keydown.enter)="selectLanguage(language)"
                (keydown.space)="selectLanguage(language); $event.preventDefault()"
              >
                <span class="language-switcher__option-code">{{
                  language.code.toUpperCase()
                }}</span>
                <span class="language-switcher__option-name">{{ language.nativeName }}</span>
                @if (language.code === currentLanguage().code) {
                  <eb-icon name="heroCheck" size="sm" aria-hidden="true" />
                }
              </li>
            }
          </ul>
        </div>
      }
    } @else {
      <!-- Inline Variant -->
      @for (language of languages; track language.code) {
        <eb-button
          [variant]="language.code === currentLanguage().code ? 'primary' : 'ghost'"
          [size]="size()"
          class="language-switcher__inline-button"
          [ariaLabel]="language.nativeName"
          [ariaPressed]="language.code === currentLanguage().code"
          (clicked)="selectLanguage(language)"
        >
          {{ language.code.toUpperCase() }}
        </eb-button>
      }
    }
  </div>
</ng-container>
