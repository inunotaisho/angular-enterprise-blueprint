<eb-container>
  <ng-container *transloco="let t">
    <eb-stack spacing="lg">
      <header class="modules__header">
        <h1 class="modules__title">{{ t('modules.title') }}</h1>
        <p class="modules__subtitle">{{ t('modules.subtitle') }}</p>
      </header>

      <!-- Search Section -->
      <div class="modules__search">
        <eb-input
          [value]="searchValue()"
          (valueChange)="onSearchChange($event)"
          [placeholder]="t('modules.searchPlaceholder')"
          [ariaLabel]="t('modules.searchLabel')"
          type="search"
          inputId="module-search"
        >
        </eb-input>
        @if (store.filter()) {
          <span class="modules__search-count">
            {{ t('modules.resultsCount', { count: store.filteredModules().length }) }}
          </span>
        }
      </div>

      <!-- Loading State -->
      @if (store.isLoading()) {
        <div class="modules__loading">
          {{ t('common.loading') }}
        </div>
      }

      <!-- Error State -->
      @if (store.error()) {
        <div class="modules__error">
          {{ store.error() }}
        </div>
      }

      <!-- Modules Grid -->
      @if (!store.isLoading() && !store.error()) {
        @if (store.filteredModules().length > 0) {
          <eb-grid [cols]="1" [colsMd]="2" [colsLg]="3" gap="lg">
            @for (module of store.filteredModules(); track module.id) {
              <a [routerLink]="['/modules', module.id]" class="module-card-link">
                <eb-card class="module-card" [hoverable]="true">
                  <eb-stack card-body spacing="md">
                    <div class="module-card__header">
                      <h3 class="module-card__title">
                        {{ t('modules.data.' + module.id + '.title') }}
                      </h3>
                      <eb-badge
                        [variant]="getStatusVariant(module.status)"
                        [content]="t('modules.statuses.' + module.status)"
                        [ariaLabel]="
                          t('modules.detail.statusLabel', {
                            status: t('modules.statuses.' + module.status),
                          })
                        "
                        position="inline"
                      >
                      </eb-badge>
                    </div>

                    <p class="module-card__description">
                      {{ t('modules.data.' + module.id + '.description') }}
                    </p>

                    <div class="module-card__meta">
                      <eb-badge
                        [variant]="getCategoryVariant(module.category)"
                        [content]="t('modules.categories.' + module.category)"
                        [ariaLabel]="
                          t('modules.detail.categoryLabel', {
                            category: t('modules.categories.' + module.category),
                          })
                        "
                        position="inline"
                      >
                      </eb-badge>
                    </div>

                    <div class="module-card__tags">
                      @for (tag of module.tags.slice(0, 3); track tag) {
                        <span class="module-card__tag">{{ tag }}</span>
                      }
                      @if (module.tags.length > 3) {
                        <span class="module-card__tag module-card__tag--more">
                          +{{ module.tags.length - 3 }}
                        </span>
                      }
                    </div>

                    <div class="module-card__actions">
                      <eb-button
                        variant="secondary"
                        size="sm"
                        [ariaLabel]="t('modules.viewDetails') + ' ' + module.title"
                      >
                        {{ t('modules.viewDetails') }}
                        <eb-icon
                          [name]="ICONS.CHEVRON_RIGHT"
                          size="sm"
                          [decorative]="true"
                        ></eb-icon>
                      </eb-button>
                    </div>
                  </eb-stack>
                </eb-card>
              </a>
            }
          </eb-grid>
        } @else {
          <div class="modules__empty">
            <eb-icon
              [name]="ICONS.SEARCH"
              size="xl"
              class="modules__empty-icon"
              [decorative]="true"
            ></eb-icon>
            <h2 class="modules__empty-title">{{ t('modules.noResults') }}</h2>
            <p class="modules__empty-text">{{ t('modules.noResultsHint') }}</p>
            @if (store.filter()) {
              <eb-button
                variant="secondary"
                [ariaLabel]="t('modules.clearSearch')"
                (click)="clearSearch()"
              >
                {{ t('modules.clearSearch') }}
              </eb-button>
            }
          </div>
        }
      }
    </eb-stack>
  </ng-container>
</eb-container>
